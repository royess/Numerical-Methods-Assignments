# 报告

## 运行提示

测试环境: Linux, julia version 1.4.1.

命令行中运行上机习题的结果:

```bash
julia exercise.jl
```

Julia 提供了很方便的 BenchmarkTools 来测试性能, 报告中的性能数据都是用它测出的. 使用请参考[官方文档](https://github.com/JuliaCI/BenchmarkTools.jl).

## 实验分析

### Gauss 消元法

选列主元的 Guass 消元法结果和精确结果接近. 而不选主元的 Gauss 消元法, $x_i$ 的误差是逐级指数放大的, 在靠后的分量中 $x_{i+1}$ 的误差大概是 $x_i$ 的两倍.

经过简单的 benchmarking, 选列主元和不选主元的平均计算用时分别为 1.814ms 和 1.772ms. 考虑到两者精确度的差距, 计算时间的增加是完全可以接受的.

总的来说, 为了控制 Gauss 消元法的误差积累, 选列主元是必要的.

### 平方根法和改进的平方根法

和平方根法相比, 改进的平方根法消耗的时间是更少的. 在第 1 问的问题中, 平方根法平均用时 1.976ms, 改进的平方根法用时 0.469ms, 加速比达到了 4.2 倍; 在第 2 问的问题中, 平方根法平均用时 5.803ms, 改进的平方根法用时 3.818ms. 加速比达到了 1.5 倍. 这说明开方的运算确实很耗时, 改进是很经济的.

改进的平方根法还有另一个优势, 在第 2 问中极度病态的 Hilbert 矩阵中才能显示出来. 当数值精度不足时 (例如在我的程序中改用 64 位浮点数, 而不是 128 位浮点数), 计算中矩阵的对角元素可能会由于误差变成负数. 这时 Cholesky 分解就会失败, 但是 LDLT 分解仍然可以工作, 并且给出误差可以接受的结果. 换言之, 改进的平方根法对于接近奇异的正定矩阵更加 robust.

*关于如何解决 Cholesky 分解中出现的的负对角元, 我考虑了一下但没有想到好的办法... 一种做法是直接让矩阵变成复矩阵, 这样的误差可以接受, 但计算时间代价太大. 总之 LDLT 分解很多情况下是个更好的办法.*